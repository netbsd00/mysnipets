x86 asm, visual studio tested.